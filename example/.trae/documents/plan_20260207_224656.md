I will refactor the `Keyboard` implementation to align with the project's style (wrapper/device).

**Analysis of current `Keyboard` implementation:**
*   Uses `KEYBOARD` namespace (Uppercase). Project uses `wrapper` or `device` (Lowercase).
*   Uses `struct` with `_t` suffix. Project style seems to use CamelCase for types without `_t`.
*   Uses `snake_case` for private members with leading underscore. This is acceptable but I should check if it matches project style (usually `member_` or `_member`). Project seems to use `member_` (trailing underscore) or just `snake_case` in some places. I'll stick to `member_` as seen in `AudioCodec` (`logger_`, `i2s_bus_`).
*   Uses hardcoded pins and logic in `keyboard.cpp` that should be configurable.
*   The `Keyboard` class should be a `device` or `wrapper` component. Given it's a specific peripheral (Cardputer Keyboard), it fits as a device or a specialized wrapper.
*   I will rename `KEYBOARD` namespace to `wrapper` or `device`? Since it's in `main` currently, maybe keep it simple or move it. But the user asked to refactor `keyboard.cpp/h`.
*   I will verify the `keymap.h` - it's a list of defines. I can wrap it in a namespace or keep it as is (C-style headers often stay as is).

**Refactoring Plan:**

1.  **`keymap.h`**:
    *   Add `#pragma once`.
    *   Wrap in `namespace WrapperEsp32 { namespace keymap { ... } }` or just `namespace WrapperEsp32`.
    *   Actually, since these are `#define` macros, namespaces won't help much unless converted to `constexpr` or `enum`.
    *   I will convert `#define` to `constexpr` or `enum class` if possible, but that's a big change.
    *   For now, I'll keep the macros but maybe clean up the file structure. The user asked to refactor it too. I'll wrap the `typedef`s in `namespace WrapperEsp32`.

2.  **`keyboard.h`**:
    *   Change namespace to `wrapper` (or `device` if appropriate, but `wrapper` is used in `app_main.cpp`).
    *   Rename structs: `Chart_t` -> `KeyChart`, `Point2D_t` -> `Point2D`, `KeyValue_t` -> `KeyValue`, `KeysState` -> `KeyState`.
    *   Update `Keyboard` class:
        *   Accept configuration in constructor (pins).
        *   Use `Logger`? The current implementation doesn't use it, but it should for consistency.
        *   Rename methods to CamelCase (`init` -> `Init`, `getKey` -> `GetKey`, etc.).
        *   Use `member_` style for private variables.

3.  **`keyboard.cpp`**:
    *   Implement the changes.
    *   Move the static maps/charts to be private static members or anonymous namespace constants.

**Specific Steps:**

1.  **Refactor `keymap.h`**:
    *   Wrap structs/enums in `namespace WrapperEsp32`.

2.  **Refactor `keyboard.h`**:
    *   Namespace `wrapper`.
    *   Class `CardputerKeyboard` (or just `Keyboard` if generic enough, but this implementation is very Cardputer specific). I'll keep `Keyboard` for now as per file name.
    *   Add `KeyboardConfig` struct?
    *   Constructor: `Keyboard(const std::vector<int>& inputs, const std::vector<int>& outputs)`.
    *   Methods: `Init()`, `Tick()`/`Update()`.

3.  **Refactor `keyboard.cpp`**:
    *   Update implementation.
    *   Use `gpio` wrapper if available? Or raw IDF calls are fine inside the wrapper.

4.  **Update `app_main.cpp`**:
    *   Update usage of `Keyboard` class.

**Note on `keymap.h`**:
*   It has `search_hid_key` and `search_fn` declarations but no implementation in `keyboard.cpp`?
*   Wait, `keymap.h` seems to be from another project (`esp32s3-keyboard`).
*   I will leave `keymap.h` largely as is (definitions) but maybe wrap the C++ parts.

**Let's refine the `Keyboard` class:**
*   It needs `Init()`.
*   It needs `Update()` (was `updateKeyList` + `updateKeysState`).
*   It needs Getters.

I will perform the refactoring to match `wrapper` style.