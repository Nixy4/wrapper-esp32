I have analyzed `keyboard.h` and `keyboard.cpp` and also checked how it is used in `app_main.cpp`.

### Analysis

1.  **Hardcoded Pins**: The GPIO pins are hardcoded in `Init()`, limiting the class to a specific board layout (Cardputer). It should be configurable.
2.  **Redundant Logic**: `GetKey()` and `UpdateKeyList()` duplicate the scanning logic. `GetKey()` is less capable (only finds one key).
3.  **State Management**: `UpdateKeyList` and `UpdateKeysState` must be called in a specific order. A unified `Update()` method would be safer.
4.  **Data Types**: `Point2D` uses `int`, but coordinates are small (0-7). `int8_t` is sufficient.
5.  **Encapsulation**: Accessors return mutable references (`&`), exposing internal state. `const` references are safer.
6.  **Comparison**: `IsChanged()` only compares the *count* of pressed keys, which misses cases where the count stays the same but keys change (e.g., swapping 'A' for 'B').

### Proposed Plan

I will refactor the `Keyboard` class to improve its interface and implementation.

**1. Header (`keyboard.h`)**
*   **Add Configuration**: Introduce `struct KeyboardConfig` to pass pin definitions (inputs/outputs) to `Init()`.
*   **Optimize Types**: Change `Point2D` members to `int8_t`.
*   **Unified Update**: Add `void Update()` that calls the scanning and state processing logic internally.
*   **Const Correctness**: Return `const` references for `GetKeyList()` and `GetKeysState()`.
*   **Cleanup**: Remove `#include <iostream>`. Remove/Refactor `GetKey()` to use the shared scanning logic.

**2. Implementation (`keyboard.cpp`)**
*   **Flexible Init**: Update `Init` to accept the config struct.
*   **Robust `IsChanged`**: Implement true state comparison (check if the set of keys changed).
*   **Refactor Scanning**: Centralize scanning logic to avoid duplication between `GetKey` and `UpdateKeyList`.

**3. Usage Update (`app_main.cpp`)**
*   Update the `keyboard.Init()` call to pass the Cardputer-specific pin configuration, preserving existing behavior.

**4. Verification**
*   Since I cannot physically press keys, I will verify the code compiles and that the logic is sound.

Do you agree with this plan?